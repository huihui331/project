<template>
  <div class="main">
    <div class="toolbox-decorations">
      <!-- è£…é¥°å°å›¾å¤§å° -->
      <div class="decorations-size-inputs">
        <div>
          <label for="decoration-size-input">è£…é¥°å›¾å¤§å°ï¼š</label>
          <input
            type="range"
            name="decoration-size-input"
            id="decoration-size-input"
            :value="pictureStore.decorationImgSize"
            @input="
              changeDecorationImgSize(($event.target as HTMLInputElement).value)
            "
            min="10"
            max="500"
          />
          <output for="decoration-size-input">
            {{ pictureStore.decorationImgSize }}
          </output>
        </div>
      </div>
      <!-- è£…é¥°å°å›¾ç§ç±» -->
      <div class="decorations-buttons">
        è£…é¥°å›¾ï¼š
        <button
          type="button"
          class="btn"
          aria-label="no decorations"
          data-decoration-value="none"
          @click="changeDecorationImgSrc('', true)"
        >
          ç©ºç™½
        </button>
        <template v-for="item in allDecorationImg" :key="item.id">
          <button
            type="button"
            class="btn"
            :aria-label="item.aria_label"
            @click="changeDecorationImgSrc(item.data_decotation_value, false)"
          >
            <img :src="item.src" :alt="item.alt" />
          </button>
        </template>
      </div>
      <!-- ä¸Šä¼ è£…é¥°å°å›¾ -->
      <div class="decorations-upload">
        <div class="upload">
          <!-- ä¸Šä¼ å›¾ç‰‡ -->
          <label for="decoration-size-input">è‡ªå®šä¹‰è£…é¥°å›¾ï¼š</label>
          <input
            type="file"
            id="decoration-upload-input"
            class="btn"
            aria-label="Upload decoration"
            @change="uploadPicture"
            ref="uploadRef"
          />
        </div>
        <!-- <div class="preview-decoration" alt="Preview uploaded decoration"></div> -->
        <!-- åº•éƒ¨æç¤º -->
        <div class="myoctocats-tip">
          <p>
            ğŸ’¡ä½¿ç”¨
            <a
              href="https://octodex.github.com/"
              target="_blank"
              rel="noopener noreferrer"
            >
              Github Octodex
            </a>
            ä¸­çš„octocat
          </p>
          <p>
            ğŸ’¡æˆ–è€…åœ¨
            <a
              href="https://myoctocat.com/"
              target="_blank"
              rel="noopener noreferrer"
            >
              MyOctocat.com
            </a>
            ä¸Šæ„å»ºè‡ªå·±çš„octocat
          </p>
          <p>ğŸ’¡octocatçœ‹èµ·æ¥åäº†ï¼Œä½†æ˜¯å¯ä»¥å¤åˆ¶svgç»“æœ</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { reactive, ref } from 'vue'
// å¼•å…¥ä»“åº“
import usePictureStore from '@/stores/picture'

// ä»“åº“å®ä¾‹
let pictureStore = usePictureStore()
// ä¸Šä¼ å›¾ç‰‡è¾“å…¥æ¡†å®ä¾‹
let uploadRef = ref()
// è£…é¥°å°å›¾ç§ç±»æ•°æ®
let allDecorationImg = reactive([
  {
    id: 1,
    aria_label: 'my-octocatå°å›¾æŒ‰é’®',
    data_decotation_value: 'my-octocat.png',
    src: '/src/assets/images/decorations/my-octocat-thumbnail.png',
    alt: 'my-octocatå°å›¾',
  },
  {
    id: 2,
    aria_label: 'octocatå°å›¾æŒ‰é’®',
    data_decotation_value: 'octocat.png',
    src: '/src/assets/images/decorations/octocat-thumbnail.png',
    alt: 'octocat',
  },
  {
    id: 3,
    aria_label: 'github-markå°å›¾æŒ‰é’®',
    data_decotation_value: 'github-mark.png',
    src: '/src/assets/images/decorations/github-mark-thumbnail.png',
    alt: 'github-mark',
  },
  {
    id: 4,
    aria_label: 'dev-badgeå°å›¾æŒ‰é’®',
    data_decotation_value: 'dev-badge.png',
    src: '/src/assets/images/decorations/dev-badge-thumbnail.png',
    alt: 'dev-badgeå°å›¾',
  },
  {
    id: 5,
    aria_label: 'dev-rainbowå°å›¾æŒ‰é’®',
    data_decotation_value: 'dev-rainbow.png',
    src: '/src/assets/images/decorations/dev-rainbow-thumbnail.png',
    alt: 'dev-rainbowå°å›¾',
  },
  {
    id: 6,
    aria_label: 'dev-whiteå°å›¾æŒ‰é’®',
    data_decotation_value: 'dev-white.png',
    src: '/src/assets/images/decorations/dev-white-thumbnail.png',
    alt: 'dev-whiteå°å›¾',
  },
  {
    id: 7,
    aria_label: 'codeå°å›¾æŒ‰é’®',
    data_decotation_value: 'code.png',
    src: '/src/assets/images/decorations/code-thumbnail.png',
    alt: 'codeå°å›¾',
  },
  {
    id: 8,
    aria_label: 'terminalå°å›¾æŒ‰é’®',
    data_decotation_value: 'terminal.png',
    src: '/src/assets/images/decorations/terminal-thumbnail.png',
    alt: 'terminalå°å›¾',
  },
  {
    id: 9,
    aria_label: 'programmingå°å›¾æŒ‰é’®',
    data_decotation_value: 'programming.png',
    src: '/src/assets/images/decorations/programming-thumbnail.png',
    alt: 'programmingå°å›¾',
  },
  {
    id: 10,
    aria_label: 'rocketå°å›¾æŒ‰é’®',
    data_decotation_value: 'rocket.png',
    src: '/src/assets/images/decorations/rocket-thumbnail.png',
    alt: 'rocketå°å›¾',
  },
  {
    id: 11,
    aria_label: 'terminal-circleå°å›¾æŒ‰é’®',
    data_decotation_value: 'terminal-circle.png',
    src: '/src/assets/images/decorations/terminal-circle-thumbnail.png',
    alt: 'terminal-circleå°å›¾',
  },
  {
    id: 12,
    aria_label: 'binary-codeå°å›¾æŒ‰é’®',
    data_decotation_value: 'binary-code.png',
    src: '/src/assets/images/decorations/binary-code-thumbnail.png',
    alt: 'binary-codeå°å›¾',
  },
  {
    id: 13,
    aria_label: 'coding-screenå°å›¾æŒ‰é’®',
    data_decotation_value: 'coding-screen.png',
    src: '/src/assets/images/decorations/coding-screen-thumbnail.png',
    alt: 'coding-screenå°å›¾',
  },
  {
    id: 14,
    aria_label: 'codingå°å›¾æŒ‰é’®',
    data_decotation_value: 'coding.png',
    src: '/src/assets/images/decorations/coding-thumbnail.png',
    alt: 'codingå°å›¾',
  },
  {
    id: 15,
    aria_label: 'ideaå°å›¾æŒ‰é’®',
    data_decotation_value: 'idea.png',
    src: '/src/assets/images/decorations/idea-thumbnail.png',
    alt: 'ideaå°å›¾',
  },
  {
    id: 16,
    aria_label: 'tabså°å›¾æŒ‰é’®',
    data_decotation_value: 'tabs.png',
    src: '/src/assets/images/decorations/tabs-thumbnail.png',
    alt: 'tabså°å›¾',
  },
  {
    id: 17,
    aria_label: 'appleå°å›¾æŒ‰é’®',
    data_decotation_value: 'apple.png',
    src: '/src/assets/images/decorations/apple-thumbnail.png',
    alt: 'appleå°å›¾',
  },
])

// æ”¹å˜è£…é¥°å°å›¾å¤§å°
function changeDecorationImgSize(decorationImgSize: string) {
  pictureStore.decorationImgSize = decorationImgSize
}

// æ”¹å˜è£…é¥°å°å›¾
function changeDecorationImgSrc(
  decorationImgSrc: string,
  decorationImgsHidden: boolean,
) {
  pictureStore.decorationImgSrc = decorationImgSrc
  pictureStore.decorationImgsHidden = decorationImgsHidden
}

// ä¸Šä¼ å›¾ç‰‡
function uploadPicture() {
  let reader = new FileReader()
  reader.readAsDataURL(uploadRef.value.files[0])
  reader.onload = function (e) {
    pictureStore.decorationImgsHidden = false // ç”¨æˆ·ç‚¹å‡»äº†ç©ºç™½ï¼Œç„¶åå†ä¸Šä¼ å›¾ç‰‡ï¼Œæ­¤æ—¶è¦è®©å›¾ç‰‡æ˜¾ç¤º
    pictureStore.decorationImgSrc = reader.result as string
  }
}
</script>

<style scoped lang="scss">
/* åŠ¨ç”»ï¼šé€æ˜åº¦ä» 0 åˆ° 1 */
@keyframes fadeEffect {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

// æ‰‹æœºç«¯
.main {
  // èƒŒæ™¯é€‰é¡¹å¡ä¸‹æ–¹å±•ç¤ºåŒºåŸŸ
  padding: 15px 15px 15px 15px;
  animation: fadeEffect 1s; /* é€æ˜åº¦åŠ¨ç”»æ—¶é•¿1s */

  .toolbox-decorations {
    box-sizing: border-box;

    > div {
      display: flex;
      align-items: center;
      justify-content: start;
      flex-wrap: wrap;

      &:not(:last-child) {
        margin-top: 5px;
        margin-bottom: 22px;
      }
    }

    // è£…é¥°å›¾ç§ç±»åŒºåŸŸ
    .decorations-buttons {
      button {
        width: 50px;
        height: 50px;
        padding: 0;
        margin-left: 5px;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        justify-content: center;

        img {
          max-width: 40px;
          max-height: 40px;
        }

        &.selected {
          border: solid white 2px;
        }
      }
    }

    // ä¸Šä¼ åŒºåŸŸ + åº•éƒ¨æç¤º
    .decorations-upload {
      padding-top: 2px;
      // ä¸Šä¼ åŒºåŸŸ
      .upload {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        margin-right: 30px;
      }

      // åº•éƒ¨æç¤º
      .myoctocats-tip {
        display: inline-block;
        margin-top: 20px;
        margin-bottom: 10px;
        padding: 5px 10px;
        border-radius: var(--input-border-radius);
        font-size: 0.9rem;
        line-height: 1.5;
        background: rgba(255, 255, 255, 0.15);

        p {
          margin: 8px 0px 10px 0px;
          a {
            font-weight: 700;
            text-decoration: underline;
          }
        }
      }
    }
  }
}

// ç”µè„‘ç«¯
@media screen and (min-width: 768px) {
  .main {
    .toolbox-decorations {
      max-width: 600px;
      margin: auto;

      > div {
        justify-content: center;

        &:not(:last-child) {
          margin-top: 5px;
          margin-bottom: 22px;
        }
      }

      // è£…é¥°å›¾ç§ç±»åŒºåŸŸ
      .decorations-buttons {
        margin-bottom: 22px;
      }

      // ä¸Šä¼ åŒºåŸŸ + åº•éƒ¨æç¤º
      .decorations-upload {
        margin-top: -15px;
        padding-top: 0px;
      }
    }
  }
}
</style>
